(function(){var e;htmx.defineExtension("sse",{init:function(t){e=t,htmx.createEventSource==void 0&&(htmx.createEventSource=d)},onEvent:function(t,n){switch(t){case"htmx:beforeCleanupElement":var o=e.getInternalData(n.target);o.sseEventSource&&o.sseEventSource.close();return;case"htmx:afterProcessNode":s(n.target),c(n.target)}}});function d(e){return new EventSource(e,{withCredentials:!0})}function i(e){return e.trim().split(/\s+/)}function l(t){var n,s,o,a=e.getAttributeValue(t,"hx-sse");if(a)for(s=i(a),n=0;n<s.length;n++)if(o=s[n].split(/:(.+)/),o[0]==="connect")return o[1]}function r(t){var n,s,o,a=e.getAttributeValue(t,"hx-sse"),r=[];if(a!=null)for(s=i(a),n=0;n<s.length;n++)o=s[n].split(/:(.+)/),o[0]==="swap"&&r.push(o[1]);return r}function c(s){var i,a,o=e.getClosestMatch(s,h);if(o==null)return null;a=e.getInternalData(o),i=a.sseEventSource,t(s,"sse-swap").forEach(function(t){var a,c,l,d,h=e.getAttributeValue(t,"sse-swap");h?(a=h.split(",")):(a=r(t));for(c=0;c<a.length;c++)d=a[c].trim(),l=function(a){if(n(o))return;e.bodyContains(t)||i.removeEventListener(d,l),u(t,a.data),e.triggerEvent(s,"htmx:sseMessage",a)},e.getInternalData(t).sseEventListener=l,i.addEventListener(d,l)}),t(s,"hx-trigger").forEach(function(t){var a,s=e.getAttributeValue(t,"hx-trigger");if(s==null)return;if(s.slice(0,4)!="sse:")return;s=s.substr(4),a=function(){if(n(o))return;e.bodyContains(t)||i.removeEventListener(s,a)}})}function s(n,s){if(n==null)return null;t(n,"sse-connect").forEach(function(t){var n=e.getAttributeValue(t,"sse-connect");if(n==null)return;o(t,n,s)}),t(n,"hx-sse").forEach(function(e){var t=l(e);if(t==null)return;o(e,t,s)})}function o(t,o,i){var a=htmx.createEventSource(o);a.onerror=function(o){if(e.triggerErrorEvent(t,"htmx:sseError",{error:o,source:a}),n(t))return;if(a.readyState===EventSource.CLOSED){i=i||0;var r=Math.random()*(2^i)*500;window.setTimeout(function(){s(t,Math.min(7,i+1))},r)}},a.onopen=function(){e.triggerEvent(t,"htmx:sseOpen",{source:a})},e.getInternalData(t).sseEventSource=a}function n(t){if(!e.bodyContains(t)){var n=e.getInternalData(t).sseEventSource;if(n!=null)return n.close(),!0}return!1}function t(t,n){var s=[];return e.hasAttribute(t,n)&&s.push(t),t.querySelectorAll("["+n+"], [data-"+n+"]").forEach(function(e){s.push(e)}),s}function u(t,n){e.withExtensions(t,function(e){n=e.transformResponse(n,null,t)});var o=e.getSwapSpecification(t),i=e.getTarget(t),s=e.makeSettleInfo(t);e.selectAndSwap(o.swapStyle,i,t,n,s),s.elts.forEach(function(t){t.classList&&t.classList.add(htmx.config.settlingClass),e.triggerEvent(t,"htmx:beforeSettle")}),o.settleDelay>0?setTimeout(a(s),o.settleDelay):a(s)()}function a(t){return function(){t.tasks.forEach(function(e){e.call()}),t.elts.forEach(function(t){t.classList&&t.classList.remove(htmx.config.settlingClass),e.triggerEvent(t,"htmx:afterSettle")})}}function h(t){return e.getInternalData(t).sseEventSource!=null}})()